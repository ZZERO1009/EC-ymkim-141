# LAB: Line Tracing RC Car  

**Date: 2023.11.23.

**Author/Partner:** 21900141 Youngmin Kim& Yoon Seok

**Github**:  https://github.com/ZZERO1009/EC-ymkim-141/blob/bb3ff54e9b8d058eb48a4e1386a6f46125f68621/docs/LAB_USART_report_21900141_youngmin_Kim.md




## Introduction

Design an embedded system to control an RC car to drive on the racing track. The car is controlled either manually with wireless communication or automatically to drive around the track. 

When it sees an obstacle on the driving path, it should temporarily stop until the obstacle is out of the path.

![image](https://github.com/ZZERO1009/EC-ymkim-141/assets/144536736/396d90bf-928b-4cca-9fd9-c6f217d89475)
### Requirement

#### Hardware 

* MCU
  * NUCLEO-F401RE


* Actuator/Sensor/Others:
	* Bluetooth Module(HC-06)
	* DC motor x2, DC motor driver(L9110s)
	* IR Reflective Sensor (TCRT 5000) x2
	* HC-SR04
	* additional sensor/actuators are acceptable

#### Software
 * Keil uVision, CMSIS, EC_HAL library



## Problem Definition
Design your RC car that has the following functions:
1. Line tracing on the given racing track
2. has 2 control modes: Manual Mode to AUTO Mode
3. stops temporally when it detects an object nearby on the driving path

On the PC, connected to MCU via bluetooth
* Print the car status every 1 sec such as “ ( “ MOD: A DIR: F STR: 00 VEL: 00 ”)
### Manual Mode
* Mode Change( MOD):
	* When 'M' or 'm' is pressed, it should enter Manual Mode
	* LD2 should be ON in Manual Mode
*  Speed (VEL):
	* Increase or decrease speed each time you push the arrow key “UP” or “DOWN”, respectively.
	* You can choose the speed keys
	* Choose the speed level: V0 ~ V3
* Steer (STR):
	* Steering control with keyboard keys
	* Increase or decrease the steering angles each time you press the arrow key “RIGHT” or “LEFT”, respectively.
	* Steer angles with 3 levels for both sides: e.g: -3, -2, -1, 0, 1, 2, 3 // '-' angle is turning to left
* Driving Direction (DIR)
	* Driving direction is forward or backward by pressing the key “F” or “B”, respectively.
	* You can choose the control keys
* Emergency Stop
	* RC car must stop running when key “S” is pressed.
### Automatic Mode
* Mode Change:
	* When 'A' or 'a' is pressed, it should enter AUTO Mode
* LD2 should blink at 1 second rate in AUTO Mode
* It should drive on the racing track continuously
* Stops temporally when it detects an object nearby on the driving path
* If the obstacle is removed, it should drive continuously

## Procedure

For algorithm, beginig(reset) mode is Manual mode. and then, highest choice is mode select.

If choose Manual mode, if emergency pressed, must stop, others controled by keyboard.

If choose Auto mode, Danger close, must stop, and then, must follow line.

![image](https://github.com/ZZERO1009/EC-ymkim-141/assets/144536736/a3dc7d2f-7f5c-4f55-bd18-65b4ddf0098e)

![image](https://github.com/ZZERO1009/EC-ymkim-141/assets/144536736/46fc7cc8-ecc9-42e5-ab33-0fd3b3fed979)

Flag is for ADC read and ICAP and interrupt.

![image](https://github.com/ZZERO1009/EC-ymkim-141/assets/144536736/ba7104f0-1dee-4170-8fa4-12a2dffa5814)




